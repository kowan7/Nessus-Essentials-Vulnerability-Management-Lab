<h1>Nessus Essentials Vulnerability Management Lab</h1>

<h2>Description</h2>
I undertook a project to establish a Virtual Machine environment using VMWare, with Windows 10 as the operating system. The primary objective was to enhance my proficiency with Nessus Essentials and develop skills in identifying and addressing vulnerabilities. This project focuses on two key phases of the Vulnerability Management Lifecycle.
To execute this, I utilized Nessus Essentials to conduct comprehensive scans on local Virtual Machines hosted on VMWare Workstation. The scans included credentialed scans to identify vulnerabilities. Following the identification phase, I proceeded to remediate some of the discovered vulnerabilities. Subsequently, I conducted a rescan to validate the effectiveness of the remediation efforts.
Additionally, critical vulnerabilities were targeted for remediation to bring the overall environment to an acceptable risk level. This comprehensive walkthrough showcases my hands-on experience in Vulnerability Management, highlighting the practical implementation of key lifecycle steps.

<h2>Utilities Used</h2>

- <b>Nessus Essentials</b> 
- <b>CMD</b>

<h2>Environments Used </h2>

- <b>VMWare</b>
- <b>Windows 10</b> (21H2)

<h2>Links</h2>

- <b>VMWare Workstation Pro:</b> https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html
- <b>Nessus Essentials:</b> https://www.tenable.com/products/nessus/nessus-essentials
- <b>Windows 10 ISO:</b> https://www.microsoft.com/en-us/software-download/windows10

<h2 align="center">Program walk-through</h2>

<b>My initial task involves downloading Nessus Essentials, the vulnerability management software. Given the time-consuming nature of this download, I use the opportunity to multitask. Concurrently, I download Windows 10 onto a Virtual Machine and proceed to configure it, a process that also demands a considerable amount of time.</b> 
<br/>
</p>

![Downloading Nessus](https://user-images.githubusercontent.com/108043108/177885108-9e637032-e965-4ecb-8166-b6931dc2dcff.JPG)

<br />
<br />
<b>To effectively manage vulnerabilities on the Virtual Machine, I needed to configure the network adapter in bridged mode to align it with my native network. This configuration was necessary because Nessus requires Secure Server Login (SSL) access to the Virtual Machine, and connecting it to my local network streamlines the process.
During the setup, I encountered a connectivity issue where the Virtual Machine lacked internet access. After thorough troubleshooting, I identified the problem: there was an additional network adapter or NIC card installed by the VirtualBox software on my computer. Once I disabled this card, I successfully established an internet connection for the Virtual Machine.
</b> 
<br/>
</p>

![Configure_Network_Adapters](https://user-images.githubusercontent.com/108043108/177885541-29039f1c-6217-43b4-92ca-86a60d092d3b.JPG)

<br />
<br />

<b>Currently, Nessus is in the downloading process, while my Virtual Machine has efficiently downloaded Windows 10. To proceed, I open the Command Prompt (CMD) to determine the VM's IP address, a crucial step for executing vulnerability scans with Nessus. I designated the Virtual Machine as "Admin." The screenshot clearly displays the IP address as 192.168.1.119.

</b> 
<br/>
 
![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/ce06b848-fdd3-4182-aa8a-5cb437a59a96)




<br />
<br />

<b>Now that Nessus Essentials has finished downloading, I begin by creating a new scan. Specifically, I choose the Basic Network Scan as my preferred option to initiate the scanning process.</b> <br/>
</p>

![Create_New_Scan](https://user-images.githubusercontent.com/108043108/177887661-793476e8-7e68-4c21-8983-8f955d7cff2e.JPG)

![basic_network_scan](https://user-images.githubusercontent.com/108043108/177887672-2d955508-edf1-4735-b78a-2836a81d2c9f.JPG)


<br />
<br />
<b>The newly created scan asks me to name the scan and select a target to scan. I configure it to scan the VM's IP address which is 192.168.1.119 </b> <br/>
</p>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/53ec9967-436d-4b18-8186-6c3dd84ef9db)

<br />
<br />
<b>I launch the newly created scan and it immediately goes to work scanning for any known vulnerabilities. </b> <br/>
</p>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/1fcdffa8-98e8-4af4-bc92-f84d0fb39062)

<br />
<br />

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/53fcc7de-5079-4d09-9b08-d574e6937e55)

<br />
<br />

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/658b375a-ebde-420d-92ce-2f138844e73f)

<br />
<br />
<b>Now, let's examine the results. The report indicates a total of 32 vulnerabilities, with 31 falling under the category of informational and 1 classified as medium severity. In a real production environment, these informational findings would likely be left unaddressed, with the exception of cases like "SMB signing not required." Issues of this nature are critical and would be promptly remediated to enhance the overall security posture of the system.
<br />
<br />
<b>Looking at one of the INFO results you can see that the Target Credential Status By Authentication Procotol was triggered because we did not actually provide any credentials for this scan. </b> <br/>
</p>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/1d6e6d4d-6f51-4c69-9d63-2f1a74b0f742)

<br />
<br />

<b>The subsequent step involves configuring the VM to facilitate authenticated scans and furnishing credentials to Nessus. To initiate this, I access services.msc and enable Remote Registry. Enabling Remote Registry permits Nessus to establish a connection with the VM's registry, facilitating a thorough scan for vulnerabilities like insecure connections or deprecated cipher suites. These actions align with Nessus recommendations for conducting credentialed scans. While there may be alternative methods, I'm adhering to the specified steps to ensure a comprehensive assessment. </b> <br/>
</p>
<br />
<br />

![Services_MSC](https://user-images.githubusercontent.com/108043108/177888931-9dbd1224-5155-4129-ba09-4f495976a0e2.JPG)

![Enabling_Remote_Registry](https://user-images.githubusercontent.com/108043108/177889042-0a885e18-bf64-4390-8f43-454bdaf79004.gif)

<br />
<br />

<b>Afterward, I proceed to the User Account Controls and disable them. This is a necessary procedure since the virtual machine is not connected to a domain, demanding unconventional methods to guarantee smooth operation. It's important to note that these steps, which may seem reminiscent of hacking techniques, are tailored to this non-standard configuration. It's crucial to highlight that such procedures would never be utilized in a genuine organizational or production setting. <br/>
</p>

![user_account_Settings](https://user-images.githubusercontent.com/108043108/177889466-907890fc-e67e-490b-8a17-b335263d0359.JPG)

![User_Account_settings_configuration](https://user-images.githubusercontent.com/108043108/177889473-ba988135-ce62-4717-bf04-1e426ec8c4b6.gif)

<br />
<br />
<<b>Subsequently, I enter the registry and add a key intended to enhance Nessus connectivity by additionally deactivating user account controls. This action is taken to streamline the connection process for Nessus within the specified context. </b> <br/>
</p>

![Registry_editor](https://user-images.githubusercontent.com/108043108/177889663-24088363-2291-4af0-8ea9-6f6486fc82ad.JPG)

<br />
<br />
<b>Presently, I navigate through the Registry to find the file specified by Nessus (highlighted in yellow within the search bar). Following this, I create a DWORD value named LocalAccountTokenFilterPolicy and set it to a value of 1, in accordance with the guidelines given by Nessus.</b> <br/>
</p>

![Creating_a_new_DWORD](https://user-images.githubusercontent.com/108043108/177889894-f94747fa-fa05-401f-82d4-1c9ec9faa57f.JPG)

![DWORD_name](https://user-images.githubusercontent.com/108043108/177889904-aa294428-0864-4018-8cb5-b61da5e65478.JPG)

![Edit_DWORD](https://user-images.githubusercontent.com/108043108/177889915-70e9814c-5167-460c-be85-10abf056fd8f.JPG)

<br />
<br />
<b>After doing that I have to restart the VM so the changes can take effect. </b> <br/>
</p>

![Restart_The_VM](https://user-images.githubusercontent.com/108043108/177889955-2511a00a-9b59-4b4d-a9be-c2abda9869a6.JPG)

<br />
<br />
<b>With the registry configured, it is now time to go back into Nessus and configure the scan I created. I have to add the Credentials to the scan so it can work properly. The credentials I'm talking about is the username and password of the VM. This will allow Nessus to use those credentials in places where it is required in the VM registry. </b> <br/>
</p>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/bbddb15b-5b9c-4444-93b9-0f760a387991)

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/518ddda2-c666-4834-8631-aa6d0a874f13)

<br />
<br />

<b>After the scan is properly configured with the right credentials, I run it again. </b> <br/>

<b>This scan has revealed a significantly higher number of vulnerabilities compared to the initial one, primarily attributed to the deeper scanning capabilities enabled by having valid credentials. 
The increased vulnerability count is likely a consequence of the VM's Windows 10 version not being up to date. The use of credentials allows the scanning tool to access and analyze more comprehensive information within the virtual machine, uncovering vulnerabilities that may not have been detectable in the non-credentialed scan. This underscores the importance of maintaining an updated operating system to mitigate potential security risks. </b> <br/>
</p>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/ae585cc6-66fa-4992-8125-c172e3779c1b)

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/d15e1820-e652-49dc-82a9-607592bb3743)


<br />
<br />
<b>I am interested in gauging the effectiveness of the Nessus Scanner, so I plan to download an antiquated version of Firefox, which is likely to harbor numerous vulnerabilities. The objective is to assess whether Nessus can identify and report these vulnerabilities, a scenario I am confident it will excel in. This exercise serves as a practical demonstration of Nessus's robust capabilities in uncovering security flaws even in outdated software versions. </b><br/>
</p>

![downloading_an_old_version_of_firefox](https://user-images.githubusercontent.com/108043108/177890787-5cd80be3-99a1-40a4-bddc-feb06ea9cda7.JPG)

<br />
<br />
<b>Once an outdated version of Firefox is acquired, I initiate another scan. The results reveal a plethora of new alerts and vulnerabilities solely stemming from the Firefox application. </b> <br/>
</p>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/191058ac-a9ac-4a62-8380-0db3460f8abf)

<br />
<br />
<b>A comparison between scans to show the progression of alerts and vulnerabilities.</b>  <br/>
</p>
<h2>Credentials UnConfigured</h2>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/26c582eb-3827-47fd-a220-6b235793a025)

<h2>Credentials Configured</h2>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/9f78b9a9-29ee-4b45-8342-a4665c265a9e)

<h2>Old Version of FireFox</h2>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/867b4d4c-e0bf-4b73-8aa3-df339e1a0723)

<br />
<br />
<b>Illustrating examples of alerts and vulnerabilities, it's evident that a significant portion of the Critical alerts originates from Firefox. To address these vulnerabilities, potential remediation methods include updating Firefox, likely resolving many issues, or opting to uninstall Firefox altogether. These actions serve as proactive measures to enhance the overall security posture of the system. </b>  <br/>
</p>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/fafa62c7-a497-4f3f-a6a5-5658331fb92d)

<br />
<br />

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/09f524cb-6e5c-46b6-9b04-4eade377a7d5)

<b>Initiating the remediation process for vulnerabilities, my chosen course of action is to uninstall Firefox. This straightforward step promises an immediate resolution to a substantial number of identified issues. By removing Firefox entirely, we eliminate the associated vulnerabilities, contributing to a swift and effective enhancement of the system's security posture. </b>  <br/>
</p>

![Fixing_Vulnerabilities_Uninstall_Firefox](https://user-images.githubusercontent.com/108043108/177891363-17bdc0ea-c872-434f-95a6-4bf6e4694ddf.JPG)

<br />
<br />
<b>In addressing the identified Windows vulnerabilities, my selected strategy involves updating the operating system. Given the outdated version, this process necessitates multiple restarts to bring it up to date. By undergoing this series of updates, we aim to patch known vulnerabilities and enhance the overall security of the system, ensuring it aligns with the latest security measures and patches provided by Microsoft. </br>  <br/>
</p>

![Remediating_Vulnerabilities_Updating_WIndows_1](https://user-images.githubusercontent.com/108043108/177891464-75d2b603-cadf-4923-bc1f-61409b11169d.gif)

![Remediating_Vulnerabilities_Updating_Windows](https://user-images.githubusercontent.com/108043108/177891436-a7b26e21-8376-4650-aaee-aaf4bc2e451e.JPG)

<br />
<br />
<b>After a few restarts, Windows is finally up to date. I run one more Nessus scan to find if the steps I took to remediate some of the alerts worked. </b>  <br/>
</p>

![VM_Up_To_date](https://user-images.githubusercontent.com/108043108/177891501-767d6764-8e4a-4bd0-85cc-6b70e48c62aa.JPG)

<br />
<br />
<b>In this final comparison of the four scans conducted during the lab, the last scan represents the post-remediation state. Notably, many previously flagged vulnerabilities have been successfully addressed, leaving only one critical issue. The vulnerability count decreased from 473 to 202, with 183 informational findings persisting and 1 critical issue remaining. Additionally, Nessus provided a notable reduction in remediation recommendations, decreasing from seven to just one. Also, I am currently unable to upgrade to VMware Tools version 12.3.5 or later as the latest version on the website is 10.3.0. I will update when the newer version becomes available on the website.</b>  
<br/>
</p>

<h2>Credentials UnConfigured</h2>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/26c582eb-3827-47fd-a220-6b235793a025)

<h2>Credentials Configured</h2>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/9f78b9a9-29ee-4b45-8342-a4665c265a9e)

<h2>Old Version of FireFox</h2>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/867b4d4c-e0bf-4b73-8aa3-df339e1a0723)

<h2>After some remediation</h2>

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/119d000b-6bd1-413f-bb02-1b11ecb6d472)


![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/9dedf8e4-6048-432e-a88d-eedd02a8a2ab)

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/2d1fc284-eb0b-49dc-873c-9c9deb800538)

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/c7bbe524-a519-4da7-821f-37c0437e572d)


To specifically address the critical concern related to "Microsoft 365 office app code execution" in Windows 10, the recommended solution is to update the Microsoft 365 app to its latest version. This straightforward approach is part of a broader strategy to enhance security, which includes updating the Windows operating system, utilizing security software, securing the network, educating users about potential risks, isolating or disabling affected services if necessary, seeking support from Microsoft or the software vendor, and implementing continuous monitoring for suspicious activity. By following these comprehensive steps, users can bolster their system's security, minimizing the risk of exploitation and ensuring a more robust defense against potential threats.


![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/5dffebad-a47a-4f72-bffa-b4645bbc7476)

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/e9c94955-1570-496d-942d-92023af3a60e)

Here are the steps I would take to resolve the multiple vulnerabilities in Microsoft 3D Viewer on Windows 10 (Plugin #154988): First, update the Microsoft 3D Viewer app to its latest version to ensure it includes the necessary security patches. Then, keep the Windows 10 operating system up to date using the Windows Update feature. Use updated antivirus software and run a thorough system scan. Implement network security measures, educate users about potential risks, and consider temporarily isolating or disabling the Microsoft 3D Viewer if necessary. Seek assistance from Microsoft Support if needed during the update process, and employ continuous monitoring tools to promptly detect any security threats. By following these steps, you can effectively address and mitigate the identified vulnerabilities in Microsoft 3D Viewer.

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/ee1530bd-d16b-4083-abcf-ca2c9408584d)

![image](https://github.com/kowan7/Nessus-Essentials-Vulnerability-Management-Lab/assets/143843214/e046c003-73af-47e3-810e-8d2fdfcecbb5)


To resolve the issue associated with "Windows 10 / Plugin #57608 SMB Signing Not Required," follow these steps:

1. Enable SMB Signing:
   Enable Server Message Block (SMB) signing on your Windows 10 system. SMB signing enhances the security of file and printer sharing by ensuring data integrity and authenticity.

2. Open Local Group Policy Editor:
   a. Press `Win + R` to open the Run dialog.
   b. Type `gpedit.msc` and press Enter to open the Local Group Policy Editor.

3. Navigate to Security Settings:
   a. In the Local Group Policy Editor, go to `Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options`.

4. Enable "Microsoft network client: Digitally sign communications (always)":
   a. Locate the policy named "Microsoft network client: Digitally sign communications (always)" in the right pane.
   b. Double-click on it and set the policy to "Enabled."

5. Enable "Microsoft network client: Digitally sign communications (if server agrees)":
   a. Similarly, locate the policy named "Microsoft network client: Digitally sign communications (if server agrees)" and set it to "Enabled."

6. Update Registry (if needed):
   a. Press `Win + R` to open the Run dialog.
   b. Type `regedit` and press Enter to open the Registry Editor.
   c. Navigate to `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters`.
   d. If the "RequireSecuritySignature" DWORD value is present, set its value to `1`. If not, create a new DWORD value and name it "RequireSecuritySignature."

7. **Restart the Computer:**
   After making these changes, restart your computer to apply the new SMB signing settings.


By adhering to these steps, you will successfully address the problem associated with SMB signing not being required on Windows 10 (Plugin #57608). 

Conclusion:
In conclusion, the Nessus Essential Vulnerability Management Lab provided valuable insights into identifying and addressing security vulnerabilities within our system. Through a series of scans, we observed the evolving landscape of vulnerabilities, from initial assessments to post-remediation improvements. The lab underscored the significance of regular updates, emphasizing the need to keep both software applications and the operating system current. Notably, Nessus demonstrated its effectiveness in pinpointing vulnerabilities and offering remediation recommendations. The process of resolving specific issues, such as those related to Microsoft 3D Viewer and SMB signing, showcased the practical application of security measures. This hands-on experience with Nessus has not only enhanced my understanding of vulnerability management but has also equipped me with actionable strategies to fortify the security posture of systems moving forward. Continuous vigilance, updates, and proactive measures are imperative in maintaining a resilient and secure computing environment.

<br />
<br />
<h2>The End</h2>
<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
