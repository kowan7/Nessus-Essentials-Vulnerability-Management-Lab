<h1>Nessus Essentials Vulnerability Management Lab</h1>

<h2>Description</h2>
I undertook a project to establish a Virtual Machine environment using VMWare, with Windows 10 as the operating system. The primary objective was to enhance my proficiency with Nessus Essentials and develop skills in identifying and addressing vulnerabilities. This project focuses on two key phases of the Vulnerability Management Lifecycle.
To execute this, I utilized Nessus Essentials to conduct comprehensive scans on local Virtual Machines hosted on VMWare Workstation. The scans included credentialed scans to identify vulnerabilities. Following the identification phase, I proceeded to remediate some of the discovered vulnerabilities. Subsequently, I conducted a rescan to validate the effectiveness of the remediation efforts.
Additionally, critical vulnerabilities were targeted for remediation to bring the overall environment to an acceptable risk level. This comprehensive walkthrough showcases my hands-on experience in Vulnerability Management, highlighting the practical implementation of key lifecycle steps.

<h2>Utilities Used</h2>

- <b>Nessus Essentials</b> 
- <b>CMD</b>

<h2>Environments Used </h2>

- <b>VMWare</b>
- <b>Windows 10</b> (21H2)

<h2>Links</h2>

- <b>VMWare Workstation Pro:</b> https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html
- <b>Nessus Essentials:</b> https://www.tenable.com/products/nessus/nessus-essentials
- <b>Windows 10 ISO:</b> https://www.microsoft.com/en-us/software-download/windows10

<h2 align="center">Program walk-through</h2>

<p align="center">
<b>My initial task involves downloading Nessus Essentials, the vulnerability management software. Given the time-consuming nature of this download, I use the opportunity to multitask. Concurrently, I download Windows 10 onto a Virtual Machine and proceed to configure it, a process that also demands a considerable amount of time.</b> 
<br/>
</p>

![Downloading Nessus](https://user-images.githubusercontent.com/108043108/177885108-9e637032-e965-4ecb-8166-b6931dc2dcff.JPG)

<br />
<br />
<p align="center">
<b>To effectively manage vulnerabilities on the Virtual Machine, I needed to configure the network adapter in bridged mode to align it with my native network. This configuration was necessary because Nessus requires Secure Server Login (SSL) access to the Virtual Machine, and connecting it to my local network streamlines the process.
During the setup, I encountered a connectivity issue where the Virtual Machine lacked internet access. After thorough troubleshooting, I identified the problem: there was an additional network adapter or NIC card installed by the VirtualBox software on my computer. Once I disabled this card, I successfully established an internet connection for the Virtual Machine.
</b> <br/>
</p>

![Configure_Network_Adapters](https://user-images.githubusercontent.com/108043108/177885541-29039f1c-6217-43b4-92ca-86a60d092d3b.JPG)

<br />
<br />
<p align="center">
<b>Currently, Nessus is in the downloading process, while my Virtual Machine has efficiently downloaded Windows 10. To proceed, I open the Command Prompt (CMD) to determine the VM's IP address, a crucial step for executing vulnerability scans with Nessus. I designated the Virtual Machine as "Admin." The screenshot clearly displays the IP address as 192.168.1.119.</b> <br/>
</p>

<img src="https://imgur.com/AkqscMi.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<br />
<br />
<p align="center">

<br />
<br />
<p align="center">
<b>Now that Nessus Essentials has finished downloading, I begin by creating a new scan. Specifically, I choose the Basic Network Scan as my preferred option to initiate the scanning process..</b> <br/>
</p>

![Create_New_Scan](https://user-images.githubusercontent.com/108043108/177887661-793476e8-7e68-4c21-8983-8f955d7cff2e.JPG)

![basic_network_scan](https://user-images.githubusercontent.com/108043108/177887672-2d955508-edf1-4735-b78a-2836a81d2c9f.JPG)


<br />
<br />
<p align="center">
<b>The newly created scan asks me to name the scan and select a target to scan. I configure it to scan the VM's IP address which is 192.168.1.119</b> <br/>
</p>

<img src="https://imgur.com/IkeQjuy.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>

<br />
<br />
<p align="center">
<b>I launch the newly created scan and it immediately goes to work scanning for any known vulnerabilities. When the grey checkmark appears, the scan is complete.</b> <br/>
</p>

<img src="https://imgur.com/sTjoRMY.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<br />
<br />
<img src="https://imgur.com/uWpCNKN.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<br />
<br />
<img src="https://imgur.com/RU6R1ud.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<br />
<br />
<img src="https://imgur.com/zuDbsef.png" height="100%" width="100%" alt="Disk Sanitization Steps"/>
<br />
<br />
<p align="center">
<b>Now, let's examine the results. The report indicates a total of 17 vulnerabilities, with 16 falling under the category of informational and 1 classified as medium severity. In a real production environment, these informational findings would likely be left unaddressed, with the exception of cases like "SMB signing not required." Issues of this nature are critical and would be promptly remediated to enhance the overall security posture of the system.
<br />
<br />
<p align="center">
<b>Looking at one of the INFO results you can see that the Target Credential Status By Authentication Procotol was triggered because we did not actually provide any credentials for this scan.</b> <br/>
</p>

![No_credentials_Given](https://user-images.githubusercontent.com/108043108/177888648-5679c8c1-e8ce-47e3-a424-067375964054.JPG)

<br />
<br />
<p align="center">
<b>The subsequent step involves configuring the VM to facilitate authenticated scans and furnishing credentials to Nessus. To initiate this, I access services.msc and enable Remote Registry. Enabling Remote Registry permits Nessus to establish a connection with the VM's registry, facilitating a thorough scan for vulnerabilities like insecure connections or deprecated cipher suites. These actions align with Nessus recommendations for conducting credentialed scans. While there may be alternative methods, I'm adhering to the specified steps to ensure a comprehensive assessment..</b> <br/>
</p>

![Services_MSC](https://user-images.githubusercontent.com/108043108/177888931-9dbd1224-5155-4129-ba09-4f495976a0e2.JPG)

![Enabling_Remote_Registry](https://user-images.githubusercontent.com/108043108/177889042-0a885e18-bf64-4390-8f43-454bdaf79004.gif)

<br />
<br />
<p align="center">
<b>Following that, I navigate to User Account Controls and deactivate it. This step is necessary as the VM is not on a domain, requiring unconventional measures to ensure proper functionality. It's essential to clarify that these actions, resembling hacker-like maneuvers, are specific to this non-standard setup. It's crucial to emphasize that such practices would never be employed in a real organizational or production environment.</b> <br/>
</p>

![user_account_Settings](https://user-images.githubusercontent.com/108043108/177889466-907890fc-e67e-490b-8a17-b335263d0359.JPG)

![User_Account_settings_configuration](https://user-images.githubusercontent.com/108043108/177889473-ba988135-ce62-4717-bf04-1e426ec8c4b6.gif)

<br />
<br />
<p align="center">
<b>Next, I access the registry and insert a key designed to facilitate Nessus connectivity by further disabling user account controls. This step is undertaken to ensure a smoother connection process for Nessus within the given context..</b> <br/>
</p>

![Registry_editor](https://user-images.githubusercontent.com/108043108/177889663-24088363-2291-4af0-8ea9-6f6486fc82ad.JPG)

<br />
<br />
<p align="center">
<b>Now, I traverse the Registry to locate the file indicated by Nessus (highlighted in yellow in the search bar). Subsequently, I introduce a DWORD value named LocalAccountTokenFilterPolicy and assign it a value of 1, as per the instructions provided by Nessus. </b> <br/>
</p>

![Creating_a_new_DWORD](https://user-images.githubusercontent.com/108043108/177889894-f94747fa-fa05-401f-82d4-1c9ec9faa57f.JPG)

![DWORD_name](https://user-images.githubusercontent.com/108043108/177889904-aa294428-0864-4018-8cb5-b61da5e65478.JPG)

![Edit_DWORD](https://user-images.githubusercontent.com/108043108/177889915-70e9814c-5167-460c-be85-10abf056fd8f.JPG)

<br />
<br />
<p align="center">
<b>After doing that I have to restart the VM so the changes can take effect.</b> <br/>
</p>

![Restart_The_VM](https://user-images.githubusercontent.com/108043108/177889955-2511a00a-9b59-4b4d-a9be-c2abda9869a6.JPG)

<br />
<br />
<p align="center">
<b>With the registry configured, it is now time to go back into Nessus and configure the scan I created. I have to add the Credentials to the scan so it can work properly. The credentials I'm talking about is the username and password of the VM. This will allow Nessus to use those credentials in places where it is required in the VM registry.</b> <br/>
</p>

![Configure_Nessus](https://user-images.githubusercontent.com/108043108/177890138-e6420231-4ce8-4a2d-99fb-e1e992da6ebb.JPG)

![Adding_Credentials](https://user-images.githubusercontent.com/108043108/177890151-27496a20-72b8-4763-8c82-368a06a15d3f.gif)

<br />
<br />
<p align="center">
<b>After the scan is properly configured with the right credentials, I run it again.</b> <br/>
</p>

![Run_The_Scan_Again](https://user-images.githubusercontent.com/108043108/177890377-b412d84a-d8e2-40da-9995-dddbd3c4d388.JPG)

<br />
<br />
<p align="center">
<b>This new scan has given us a lot more vulnerabilities than the first one because it is able to scan deeper into the VM due to having credentials. The top picture is the new credentialed scan and the bottom picture is from the first non-credentialed scan. Most of the vulnerabilities found is probably because the version of Windows 10 this VM is running is not up to date.</b> <br/>
</p>

![new_scan_properly_credentialed](https://user-images.githubusercontent.com/108043108/177890582-7f4d0eec-3b5f-4a5f-b708-47b3ccfb5d83.JPG)

![Old_scan_not_credentialed](https://user-images.githubusercontent.com/108043108/177890589-e4e882ab-6733-4930-ad4c-1115a2c620b3.JPG)

<br />
<br />
<p align="center">
<b>I want to see how powerful this Nessus Scanner is so I'm going to download a very old version of Firefox which probably has many vulnerabilities and see if Nessus can discover them (I'm sure it will.)</b><br/>
</p>

![downloading_an_old_version_of_firefox](https://user-images.githubusercontent.com/108043108/177890787-5cd80be3-99a1-40a4-bddc-feb06ea9cda7.JPG)

<br />
<br />
<p align="center">
<b>After a deprecated version of Firefox is downloaded, I run another scan. We can see many new alerts and vulnerabilities just from Firefox! 68 Critical!</b> <br/>
</p>

![Old_Firefox_Scan](https://user-images.githubusercontent.com/108043108/177890872-ed890db9-a15d-4de9-b3b3-6723dd161f22.JPG)

<br />
<br />
<p align="center">
<b>A comparison between scans to show the progression of alerts and vulnerabilities.</b>  <br/>
</p>

![Vulnerability_Comparison](https://user-images.githubusercontent.com/108043108/177890918-c2fc7078-34b9-4120-a430-f096169ae177.jpg)

<br />
<br />
<p align="center">
<b>Showing what some of the alerts and vulnerabilites look like. We can see most of the Critical alerts are just from Firefox. A few ways we can remediate some of the vulnerabilities is by either Updated Firefox, which will probably remediate a lot of them, or we can simply delete Firefox.</b>  <br/>
</p>

![Showing_Vulnerabilities](https://user-images.githubusercontent.com/108043108/177891162-cf86e335-0539-4f9f-abb2-7150b482e689.gif)

<br />
<br />
<p align="center">
<b>To start the process of remediating vulnerabilities, I elect to just delete Firefox. That will instantly fix a lot of these issues.</b>  <br/>
</p>

![Fixing_Vulnerabilities_Uninstall_Firefox](https://user-images.githubusercontent.com/108043108/177891363-17bdc0ea-c872-434f-95a6-4bf6e4694ddf.JPG)

<br />
<br />
<p align="center">
<b>To remediate the Windows vulnerabilities, I choose to update Windows. This version is old so it takes a few restarts to get it up to date.</b>  <br/>
</p>

![Remediating_Vulnerabilities_Updating_WIndows_1](https://user-images.githubusercontent.com/108043108/177891464-75d2b603-cadf-4923-bc1f-61409b11169d.gif)

![Remediating_Vulnerabilities_Updating_Windows](https://user-images.githubusercontent.com/108043108/177891436-a7b26e21-8376-4650-aaee-aaf4bc2e451e.JPG)

<br />
<br />
<p align="center">
<b>After a few restarts, Windows is finally up to date. I run one more Nessus scan to find if the steps I took to remediate some of the alerts worked.</b>  <br/>
</p>

![VM_Up_To_date](https://user-images.githubusercontent.com/108043108/177891501-767d6764-8e4a-4bd0-85cc-6b70e48c62aa.JPG)

<br />
<br />
<p align="center">
<b>Here is a final comparison between the four scans I took while doing this lab. The last picture is the after remediation scan. There we can see a lot of the vulnerabilities that were being alerted are gone! Still a 1 critical but I'll remediate that another time!</b>  <br/>
</p>

![After_Vulnerability_Remediation](https://user-images.githubusercontent.com/108043108/177891719-3066c9bb-38dd-4b10-b8bb-6f9dd8a45a09.JPG)

<br />
<br />


<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
